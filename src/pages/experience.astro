---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { Badge } from "@/components/ui/badge";
import { experience } from "@/data/experience";
import { siteConfig } from "@/data/site";

function formatDate(dateStr: string): string {
  const [year, month] = dateStr.split("-");
  const date = new Date(Date.UTC(parseInt(year), parseInt(month) - 1, 2));
  return date.toLocaleDateString("en-US", {
    year: "numeric",
    month: "short",
    timeZone: "UTC",
  });
}
---

<BaseLayout
  title={`Experience | ${siteConfig.author}`}
  description="Professional work experience and career history"
>
  <div class="container mx-auto max-w-5xl px-4 py-16">
    <header class="mb-12">
      <h1 class="text-3xl font-bold md:text-4xl">Work Experience</h1>
      <p class="mt-4 text-lg text-muted-foreground">
        My professional journey and career highlights
      </p>
    </header>

    <div class="relative">
      <!-- Timeline line -->
      <div
        class="absolute left-0 top-0 h-full w-px bg-border md:left-1/2 md:-translate-x-1/2"
      >
      </div>

      <div class="space-y-12">
        {
          experience.map((job, index) => (
            <div class="relative grid gap-4 md:grid-cols-2 md:gap-8">
              {/* Timeline dot */}
              <div class="absolute left-0 top-0 h-3 w-3 -translate-x-1/2 rounded-full bg-primary md:left-1/2" />

              {/* Date - visible on desktop on alternating sides */}
              <div
                class={`hidden md:block ${index % 2 === 0 ? "text-right" : "order-2 text-left"}`}
              >
                <div class="text-sm font-medium text-primary">
                  {formatDate(job.startDate)} -{" "}
                  {job.endDate === "Present"
                    ? "Present"
                    : formatDate(job.endDate)}
                </div>
              </div>

              {/* Content */}
              <div
                class={`pl-6 md:pl-0 ${index % 2 === 0 ? "" : "order-1 md:text-right"}`}
              >
                {/* Date - visible on mobile */}
                <div class="mb-2 text-sm font-medium text-primary md:hidden">
                  {formatDate(job.startDate)} -{" "}
                  {job.endDate === "Present"
                    ? "Present"
                    : formatDate(job.endDate)}
                </div>

                <h3 class="text-xl font-semibold">{job.title}</h3>
                <p class="text-muted-foreground">
                  {job.company} &middot; {job.location}
                </p>

                <ul
                  class={`mt-4 space-y-2 text-muted-foreground ${index % 2 === 0 ? "" : "md:ml-auto md:text-right"}`}
                >
                  {job.description.map((item) => (
                    <li class="text-sm">{item}</li>
                  ))}
                </ul>

                {job.technologies && (
                  <div
                    class={`mt-4 flex flex-wrap gap-2 ${index % 2 === 0 ? "" : "md:justify-end"}`}
                  >
                    {job.technologies.map((tech) => (
                      <Badge variant="secondary">{tech}</Badge>
                    ))}
                  </div>
                )}
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </div>
</BaseLayout>
